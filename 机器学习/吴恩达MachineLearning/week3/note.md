**ç”¨ç¬¬ä¸‰æ–¹LaTexå†™Githubç¬”è®°å¤ªéº»çƒ¦äº†ï¼Œè¿™ç¯‡å·²ç»æ¬è¿åˆ°[æ˜é‡‘](https://juejin.im/post/5c6bc294f265da2dca385839)**
## 1.1 å¼•å‡ºé€»è¾‘å›å½’

è™½ç„¶å¸¦ç€å›å½’ä¸¤å­—ï¼Œä½†æ˜¯å®ƒè§£å†³çš„æ˜¯åˆ†ç±»é—®é¢˜ï¼Œè€Œä¸æ˜¯é¢„æµ‹ä¸€æ®µè¿ç»­çš„å€¼ã€‚

æ ¹æ®çº¿æ€§å›å½’æ¨¡å‹æˆ‘ä»¬åªèƒ½é¢„æµ‹è¿ç»­çš„å€¼ï¼Œç„¶è€Œå¯¹äºåˆ†ç±»é—®é¢˜ï¼Œæ‹¿äºŒåˆ†ç±»ä¸¾ä¾‹ï¼Œæˆ‘ä»¬éœ€è¦è¾“å‡º0æˆ–1ï¼Œæˆ‘ä»¬å¯ä»¥é¢„æµ‹ï¼š

å½“${h_\theta}\left( x \right)>=0.5$æ—¶ï¼Œé¢„æµ‹ $y=1$ ï¼›å½“${h_\theta}\left( x \right)<0.5$æ—¶ï¼Œé¢„æµ‹ $y=0$ ã€‚

è™½ç„¶ä¸Šè¿°æè¿°çœ‹èµ·æ¥å¯ä»¥è§£å†³é—®é¢˜ï¼Œä½†æ˜¯è¿™ç§æ¨¡å‹å½“y>1æ—¶ï¼Œæ¨¡å‹ä¹Ÿä¼šå› æ­¤æ”¹å˜ï¼Œè¿™æ—¶ä»¥0.5ä½œä¸ºé˜ˆå€¼å°±ä¸åˆé€‚äº†ï¼Œè¯´æ˜çº¿æ€§æ¨¡å‹å¹¶ä¸é€‚åˆè§£å†³è¿™æ ·çš„é—®é¢˜ã€‚

è¿™æ—¶ï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ªæ–°çš„æ¨¡å‹ï¼Œè¯¥æ¨¡å‹çš„è¾“å‡ºå˜é‡èŒƒå›´å§‹ç»ˆåœ¨0å’Œ1ä¹‹é—´ã€‚
   $h_\theta \left( x \right)=g\left(\theta^{T}X \right)$
   å…¶ä¸­ï¼š
   $X$ ä»£è¡¨ç‰¹å¾å‘é‡
   $g$ ä»£è¡¨é€»è¾‘å‡½æ•°ï¼ˆ**logistic function**)æˆ–ç§°ä¸º**S**å½¢å‡½æ•°ï¼ˆ**Sigmoid function**ï¼‰ï¼Œå…¬å¼ä¸ºï¼š $g\left( z \right)=\frac{1}{1+{{e}^{-z}}}$ã€‚


**python**ä»£ç å®ç°ï¼š

```python
import numpy as np

def sigmoid(z):

  return 1 / (1 + np.exp(-z))
```

è¯¥å‡½æ•°çš„å›¾åƒä¸ºï¼š

![](https://user-gold-cdn.xitu.io/2019/2/19/16904f0099b12b53?w=300&h=152&f=jpeg&s=7045)

$h_\theta \left( x \right)$çš„ä½œç”¨æ˜¯ï¼Œå¯¹äºç»™å®šçš„è¾“å…¥å˜é‡ï¼Œæ ¹æ®é€‰æ‹©çš„å‚æ•°è®¡ç®—è¾“å‡ºå˜é‡=1çš„å¯èƒ½æ€§ï¼ˆ**estimated probablity**ï¼‰ï¼Œå³

$h_\theta \left( x \right)=P\left( y=1|x;\theta \right)$

ä¾‹å¦‚ï¼Œå¦‚æœå¯¹äºç»™å®šçš„$x$ï¼Œé€šè¿‡å·²ç»ç¡®å®šçš„å‚æ•°è®¡ç®—å¾—å‡º$h_\theta \left( x \right)=0.7$ï¼Œåˆ™è¡¨ç¤ºæœ‰70%çš„å‡ ç‡$y$ä¸ºæ­£å‘ç±»ï¼Œç›¸åº”åœ°$y$ä¸ºè´Ÿå‘ç±»çš„å‡ ç‡ä¸º1-0.7=0.3ã€‚

## 1.2 ä»£ä»·å‡½æ•°

æˆ‘ä»¬æœ‰äº†å‡è®¾h(Î¸)ï¼Œå¦‚ä¸‹å›¾

![](https://user-gold-cdn.xitu.io/2019/2/19/16904f00998f5010?w=400&h=210&f=png&s=40237)

å¯¹äºçº¿æ€§å›å½’æ¨¡å‹ï¼Œæˆ‘ä»¬å®šä¹‰çš„ä»£ä»·å‡½æ•°æ˜¯æ‰€æœ‰æ¨¡å‹è¯¯å·®çš„å¹³æ–¹å’Œã€‚ç†è®ºä¸Šæ¥è¯´ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹é€»è¾‘å›å½’æ¨¡å‹æ²¿ç”¨è¿™ä¸ªå®šä¹‰ï¼Œä½†æ˜¯é—®é¢˜åœ¨äºï¼Œå½“æˆ‘ä»¬å°†${h_\theta}\left( x \right)=\frac{1}{1+{e^{-\theta^{T}x}}}$å¸¦å…¥åˆ°è¿™æ ·å®šä¹‰äº†çš„ä»£ä»·å‡½æ•°ä¸­æ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°çš„ä»£ä»·å‡½æ•°å°†æ˜¯ä¸€ä¸ªéå‡¸å‡½æ•°ï¼ˆ**non-convexfunction**ï¼‰ã€‚

![](https://user-gold-cdn.xitu.io/2019/2/19/16904f0099a7c682?w=600&h=176&f=jpeg&s=16868)

è¿™æ„å‘³ç€æˆ‘ä»¬çš„ä»£ä»·å‡½æ•°æœ‰è®¸å¤šå±€éƒ¨æœ€å°å€¼ï¼Œè¿™å°†å½±å“æ¢¯åº¦ä¸‹é™ç®—æ³•å¯»æ‰¾å…¨å±€æœ€å°å€¼ã€‚

çº¿æ€§å›å½’çš„ä»£ä»·å‡½æ•°ä¸ºï¼š$J\left( \theta  \right)=\frac{1}{m}\sum\limits_{i=1}^{m}{\frac{1}{2}{{\left( {h_\theta}\left({x}^{\left( i \right)} \right)-{y}^{\left( i \right)} \right)}^{2}}}$ ï¼›ç„¶åæˆ‘ä»¬é‡æ–°å®šä¹‰é€»è¾‘å›å½’çš„ä»£ä»·å‡½æ•°ä¸ºï¼š

$J\left( \theta  \right)=\frac{1}{m}\sum\limits_{i=1}^{m}{{Cost}\left( {h_\theta}\left( {x}^{\left( i \right)} \right),{y}^{\left( i \right)} \right)}$ï¼Œå…¶ä¸­

![](https://user-gold-cdn.xitu.io/2019/2/19/16904f0099266f50?w=535&h=65&f=png&s=10340)

${h_\theta}\left( x \right)$ä¸ $Cost\left( {h_\theta}\left( x \right),y \right)$ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://user-gold-cdn.xitu.io/2019/2/19/16904f009a234669?w=400&h=189&f=jpeg&s=9756)

è¿™æ ·æ„å»ºçš„$Cost\left( {h_\theta}\left( x \right),y \right)$å‡½æ•°çš„ç‰¹ç‚¹æ˜¯ï¼š
- å½“å®é™…çš„  $y=1$ ä¸”${h_\theta}\left( x \right)$ä¹Ÿä¸º 1 æ—¶è¯¯å·®ä¸º 0ï¼Œå½“ $y=1$ ä½†${h_\theta}\left( x \right)$ä¸ä¸º1æ—¶è¯¯å·®éšç€${h_\theta}\left( x \right)$å˜å°è€Œå˜å¤§ï¼›
- å½“å®é™…çš„ $y=0$ ä¸”${h_\theta}\left( x \right)$ä¹Ÿä¸º 0 æ—¶ä»£ä»·ä¸º 0ï¼Œå½“$y=0$ ä½†${h_\theta}\left( x \right)$ä¸ä¸º 0æ—¶è¯¯å·®éšç€ ${h_\theta}\left( x \right)$çš„å˜å¤§è€Œå˜å¤§ã€‚

å°†æ„å»ºçš„ $Cost\left( {h_\theta}\left( x \right),y \right)$ç®€åŒ–å¦‚ä¸‹ï¼š
$Cost\left( {h_\theta}\left( x \right),y \right)=-y\times log\left( {h_\theta}\left( x \right) \right)-(1-y)\times log\left( 1-{h_\theta}\left( x \right) \right)$
å¸¦å…¥ä»£ä»·å‡½æ•°$J(\theta)$åå¾—åˆ°ï¼š
$J\left( \theta  \right)=\frac{1}{m}\sum\limits_{i=1}^{m}{[-{{y}^{(i)}}\log \left( {h_\theta}\left( {{x}^{(i)}} \right) \right)-\left( 1-{{y}^{(i)}} \right)\log \left( 1-{h_\theta}\left( {{x}^{(i)}} \right) \right)]}$
æè´Ÿå·ï¼š$J\left( \theta  \right)=-\frac{1}{m}\sum\limits_{i=1}^{m}{[{{y}^{(i)}}\log \left( {h_\theta}\left( {{x}^{(i)}} \right) \right)+\left( 1-{{y}^{(i)}} \right)\log \left( 1-{h_\theta}\left( {{x}^{(i)}} \right) \right)]}$

**Python**ä»£ç å®ç°ï¼š

```python
import numpy as np

def cost(theta, X, y):

  theta = np.matrix(theta)
  X = np.matrix(X)
  y = np.matrix(y)
  first = np.multiply(-y, np.log(sigmoid(X* theta.T)))
  second = np.multiply((1 - y), np.log(1 - sigmoid(X* theta.T)))
  return np.sum(first - second) / (len(X))
```

## 1.3 æ¢¯åº¦ä¸‹é™

åœ¨å¾—åˆ°è¿™æ ·ä¸€ä¸ªä»£ä»·å‡½æ•°ä»¥åï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•æ¥æ±‚å¾—èƒ½ä½¿ä»£ä»·å‡½æ•°æœ€å°çš„å‚æ•°äº†ã€‚ç®—æ³•ä¸ºï¼š

**Repeat** {

$\theta_j := \theta_j - \alpha \frac{\partial}{\partial\theta_j} J(\theta)$

(**simultaneously update all** )

}

æ±‚å¯¼åå¾—åˆ°ï¼š

**Repeat** {

$\theta_j := \theta_j - \alpha \frac{1}{m}\sum\limits_{i=1}^{m}{{\left( {h_\theta}\left( \mathop{x}^{\left( i \right)} \right)-\mathop{y}^{\left( i \right)} \right)}}\mathop{x}_{j}^{(i)}$

**(simultaneously update all** )

}

æ‰€ä»¥ï¼Œå¦‚æœä½ æœ‰ $n$ ä¸ªç‰¹å¾ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼š![](https://user-gold-cdn.xitu.io/2019/2/19/16904f009a37555b?w=66&h=135&f=png&s=1460)ï¼Œå‚æ•°å‘é‡$\theta $åŒ…æ‹¬${\theta_{0}}$ ${\theta_{1}}$ ${\theta_{2}}$ ä¸€ç›´åˆ°${\theta_{n}}$ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦ç”¨è¿™ä¸ªå¼å­ã€‚

**æ¨å¯¼è¿‡ç¨‹ï¼š**

$J\left( \theta  \right)=-\frac{1}{m}\sum\limits_{i=1}^{m}{[{{y}^{(i)}}\log \left( {h_\theta}\left( {{x}^{(i)}} \right) \right)+\left( 1-{{y}^{(i)}} \right)\log \left( 1-{h_\theta}\left( {{x}^{(i)}} \right) \right)]}$
è€ƒè™‘ï¼š
${h_\theta}\left( {{x}^{(i)}} \right)=\frac{1}{1+{{e}^{-{\theta^T}{{x}^{(i)}}}}}$
åˆ™ï¼š
${{y}^{(i)}}\log \left( {h_\theta}\left( {{x}^{(i)}} \right) \right)+\left( 1-{{y}^{(i)}} \right)\log \left( 1-{h_\theta}\left( {{x}^{(i)}} \right) \right)$
$={{y}^{(i)}}\log \left( \frac{1}{1+{{e}^{-{\theta^T}{{x}^{(i)}}}}} \right)+\left( 1-{{y}^{(i)}} \right)\log \left( 1-\frac{1}{1+{{e}^{-{\theta^T}{{x}^{(i)}}}}} \right)$
$=-{{y}^{(i)}}\log \left( 1+{{e}^{-{\theta^T}{{x}^{(i)}}}} \right)-\left( 1-{{y}^{(i)}} \right)\log \left( 1+{{e}^{{\theta^T}{{x}^{(i)}}}} \right)$

æ‰€ä»¥ï¼š
$\frac{\partial }{\partial {\theta_{j}}}J\left( \theta  \right)=\frac{\partial }{\partial {\theta_{j}}}[-\frac{1}{m}\sum\limits_{i=1}^{m}{[-{{y}^{(i)}}\log \left( 1+{{e}^{-{\theta^{T}}{{x}^{(i)}}}} \right)-\left( 1-{{y}^{(i)}} \right)\log \left( 1+{{e}^{{\theta^{T}}{{x}^{(i)}}}} \right)]}]$
$=-\frac{1}{m}\sum\limits_{i=1}^{m}{[-{{y}^{(i)}}\frac{-x_{j}^{(i)}{{e}^{-{\theta^{T}}{{x}^{(i)}}}}}{1+{{e}^{-{\theta^{T}}{{x}^{(i)}}}}}-\left( 1-{{y}^{(i)}} \right)\frac{x_j^{(i)}{{e}^{{\theta^T}{{x}^{(i)}}}}}{1+{{e}^{{\theta^T}{{x}^{(i)}}}}}}]$
$=-\frac{1}{m}\sum\limits_{i=1}^{m}{{y}^{(i)}}\frac{x_j^{(i)}}{1+{{e}^{{\theta^T}{{x}^{(i)}}}}}-\left( 1-{{y}^{(i)}} \right)\frac{x_j^{(i)}{{e}^{{\theta^T}{{x}^{(i)}}}}}{1+{{e}^{{\theta^T}{{x}^{(i)}}}}}]$
$=-\frac{1}{m}\sum\limits_{i=1}^{m}{\frac{{{y}^{(i)}}x_j^{(i)}-x_j^{(i)}{{e}^{{\theta^T}{{x}^{(i)}}}}+{{y}^{(i)}}x_j^{(i)}{{e}^{{\theta^T}{{x}^{(i)}}}}}{1+{{e}^{{\theta^T}{{x}^{(i)}}}}}}$
$=-\frac{1}{m}\sum\limits_{i=1}^{m}{\frac{{{y}^{(i)}}\left( 1\text{+}{{e}^{{\theta^T}{{x}^{(i)}}}} \right)-{{e}^{{\theta^T}{{x}^{(i)}}}}}{1+{{e}^{{\theta^T}{{x}^{(i)}}}}}x_j^{(i)}}$
$=-\frac{1}{m}\sum\limits_{i=1}^{m}{({{y}^{(i)}}-\frac{{{e}^{{\theta^T}{{x}^{(i)}}}}}{1+{{e}^{{\theta^T}{{x}^{(i)}}}}})x_j^{(i)}}$
$=-\frac{1}{m}\sum\limits_{i=1}^{m}{({{y}^{(i)}}-\frac{1}{1+{{e}^{-{\theta^T}{{x}^{(i)}}}}})x_j^{(i)}}$
$=-\frac{1}{m}\sum\limits_{i=1}^{m}{[{{y}^{(i)}}-{h_\theta}\left( {{x}^{(i)}} \right)]x_j^{(i)}}$
$=\frac{1}{m}\sum\limits_{i=1}^{m}{[{h_\theta}\left( {{x}^{(i)}} \right)-{{y}^{(i)}}]x_j^{(i)}}$

æ³¨ï¼šè™½ç„¶å¾—åˆ°çš„æ¢¯åº¦ä¸‹é™ç®—æ³•è¡¨é¢ä¸Šçœ‹ä¸Šå»ä¸çº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™ç®—æ³•ä¸€æ ·ï¼Œä½†æ˜¯è¿™é‡Œçš„${h_\theta}\left( x \right)=g\left( {\theta^T}X \right)$ä¸çº¿æ€§å›å½’ä¸­ä¸åŒï¼Œæ‰€ä»¥å®é™…ä¸Šæ˜¯ä¸ä¸€æ ·çš„ã€‚å¦å¤–ï¼Œåœ¨è¿è¡Œæ¢¯åº¦ä¸‹é™ç®—æ³•ä¹‹å‰ï¼Œè¿›è¡Œç‰¹å¾ç¼©æ”¾ä¾æ—§æ˜¯éå¸¸å¿…è¦çš„ã€‚

ä¸€äº›æ¢¯åº¦ä¸‹é™ç®—æ³•ä¹‹å¤–çš„é€‰æ‹©ï¼š
é™¤äº†æ¢¯åº¦ä¸‹é™ç®—æ³•ä»¥å¤–ï¼Œè¿˜æœ‰ä¸€äº›å¸¸è¢«ç”¨æ¥ä»¤ä»£ä»·å‡½æ•°æœ€å°çš„ç®—æ³•ï¼Œè¿™äº›ç®—æ³•æ›´åŠ å¤æ‚å’Œä¼˜è¶Šï¼Œè€Œä¸”é€šå¸¸ä¸éœ€è¦äººå·¥é€‰æ‹©å­¦ä¹ ç‡ï¼Œé€šå¸¸æ¯”æ¢¯åº¦ä¸‹é™ç®—æ³•è¦æ›´åŠ å¿«é€Ÿã€‚è¿™äº›ç®—æ³•æœ‰ï¼š**å…±è½­æ¢¯åº¦**ï¼ˆ**Conjugate Gradient**ï¼‰ï¼Œ**å±€éƒ¨ä¼˜åŒ–æ³•**(**Broyden fletcher goldfarb shann,BFGS**)å’Œ**æœ‰é™å†…å­˜å±€éƒ¨ä¼˜åŒ–æ³•**(**LBFGS**)


## 2.1 æ­£åˆ™åŒ–

### 2.1.1 è¿‡æ‹Ÿåˆé—®é¢˜

![](https://user-gold-cdn.xitu.io/2019/2/20/16909efe45daf4e9?w=698&h=211&f=jpeg&s=38938)

ç¬¬ä¸€ä¸ªæ¨¡å‹æ˜¯ä¸€ä¸ªçº¿æ€§æ¨¡å‹ï¼Œæ¬ æ‹Ÿåˆï¼Œä¸èƒ½å¾ˆå¥½åœ°é€‚åº”æˆ‘ä»¬çš„è®­ç»ƒé›†ï¼›ç¬¬ä¸‰ä¸ªæ¨¡å‹æ˜¯ä¸€ä¸ªå››æ¬¡æ–¹çš„æ¨¡å‹ï¼Œè¿‡äºå¼ºè°ƒæ‹ŸåˆåŸå§‹æ•°æ®ï¼Œè€Œä¸¢å¤±äº†ç®—æ³•çš„æœ¬è´¨ï¼šé¢„æµ‹æ–°æ•°æ®ã€‚æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œè‹¥ç»™å‡ºä¸€ä¸ªæ–°çš„å€¼ä½¿ä¹‹é¢„æµ‹ï¼Œå®ƒå°†è¡¨ç°çš„å¾ˆå·®ï¼Œæ˜¯è¿‡æ‹Ÿåˆï¼Œè™½ç„¶èƒ½éå¸¸å¥½åœ°é€‚åº”æˆ‘ä»¬çš„è®­ç»ƒé›†ä½†åœ¨æ–°è¾“å…¥å˜é‡è¿›è¡Œé¢„æµ‹æ—¶å¯èƒ½ä¼šæ•ˆæœä¸å¥½ï¼›è€Œä¸­é—´çš„æ¨¡å‹ä¼¼ä¹æœ€åˆé€‚ã€‚

å°±ä»¥å¤šé¡¹å¼ç†è§£ï¼Œ$x$ çš„æ¬¡æ•°è¶Šé«˜ï¼Œæ‹Ÿåˆçš„è¶Šå¥½ï¼Œä½†ç›¸åº”çš„é¢„æµ‹çš„èƒ½åŠ›å°±å¯èƒ½å˜å·®ã€‚

é—®é¢˜æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å‘ç°äº†è¿‡æ‹Ÿåˆé—®é¢˜ï¼Œåº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ

1. ä¸¢å¼ƒä¸€äº›ä¸èƒ½å¸®åŠ©æˆ‘ä»¬æ­£ç¡®é¢„æµ‹çš„ç‰¹å¾ã€‚å¯ä»¥æ˜¯æ‰‹å·¥é€‰æ‹©ä¿ç•™å“ªäº›ç‰¹å¾ï¼Œæˆ–è€…ä½¿ç”¨ä¸€äº›æ¨¡å‹é€‰æ‹©çš„ç®—æ³•æ¥å¸®å¿™ï¼ˆä¾‹å¦‚**PCA**ï¼‰

2. æ­£åˆ™åŒ–ã€‚ ä¿ç•™æ‰€æœ‰çš„ç‰¹å¾ï¼Œä½†æ˜¯å‡å°‘å‚æ•°çš„å¤§å°ï¼ˆ**magnitude**ï¼‰ã€‚

### 2.1.2 ä»£ä»·å‡½æ•°

ä¸Šé¢çš„å›å½’é—®é¢˜ä¸­å¦‚æœæˆ‘ä»¬çš„æ¨¡å‹æ˜¯ï¼š
${h_\theta}\left( x \right)={\theta_{0}}+{\theta_{1}}{x_{1}}+{\theta_{2}}{x_{2}^2}+{\theta_{3}}{x_{3}^3}+{\theta_{4}}{x_{4}^4}$
æˆ‘ä»¬å¯ä»¥ä»ä¹‹å‰çš„äº‹ä¾‹ä¸­çœ‹å‡ºï¼Œæ­£æ˜¯é‚£äº›é«˜æ¬¡é¡¹å¯¼è‡´äº†è¿‡æ‹Ÿåˆçš„äº§ç”Ÿï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬èƒ½è®©è¿™äº›é«˜æ¬¡é¡¹çš„ç³»æ•°æ¥è¿‘äº0çš„è¯ï¼Œæˆ‘ä»¬å°±èƒ½å¾ˆå¥½çš„æ‹Ÿåˆäº†ã€‚æ‰€ä»¥æˆ‘ä»¬è¦åšçš„å°±æ˜¯åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°è¿™äº›å‚æ•°$\theta $ çš„å€¼ï¼Œè¿™å°±æ˜¯æ­£åˆ™åŒ–çš„åŸºæœ¬æ–¹æ³•ã€‚

æˆ‘ä»¬æœ‰ä¸€ä¸ªè¾ƒä¸ºç®€å•çš„é˜²æ­¢è¿‡æ‹Ÿåˆçš„å‡è®¾ï¼š
$J\left( \theta  \right)=\frac{1}{2m}[\sum\limits_{i=1}^{m}{{{({h_\theta}({{x}^{(i)}})-{{y}^{(i)}})}^{2}}+\lambda \sum\limits_{j=1}^{n}{\theta_{j}^{2}}]}$

å…¶ä¸­$\lambda $åˆç§°ä¸ºæ­£åˆ™åŒ–å‚æ•°ï¼ˆ**Regularization Parameter**ï¼‰ã€‚åƒä¸‹å›¾ä¸­Regulatedå°±æ˜¯æ­£åˆ™åŒ–ä¹‹åçš„æ›²çº¿ï¼Œç›¸å¯¹æ‹Ÿåˆçš„æ›´å¥½ä¸€äº›ã€‚
![](https://user-gold-cdn.xitu.io/2019/2/20/16909fa4b7ef401d?w=300&h=243&f=jpeg&s=17246)

ä½†å¦‚æœé€‰æ‹©çš„æ­£åˆ™åŒ–å‚æ•°$\lambda$ è¿‡å¤§ï¼Œåˆ™ä¼šæŠŠæ‰€æœ‰çš„å‚æ•°éƒ½æœ€å°åŒ–äº†ï¼Œå¯¼è‡´æ¨¡å‹å˜æˆ ${h_\theta}\left( x \right)={\theta_{0}}$ï¼Œä¹Ÿå°±æ˜¯ä¸Šå›¾ä¸­çº¢è‰²ç›´çº¿æ‰€ç¤ºçš„æƒ…å†µï¼Œé€ æˆæ¬ æ‹Ÿåˆã€‚

é‚£ä¸ºä»€ä¹ˆå¢åŠ çš„ä¸€é¡¹$\lambda =\sum\limits_{j=1}^{n}{\theta_j^{2}}$ å¯ä»¥ä½¿$\theta $çš„å€¼å‡å°å‘¢ï¼Ÿ
å› ä¸ºå¦‚æœæˆ‘ä»¬ä»¤ $\lambda$ çš„å€¼å¾ˆå¤§çš„è¯ï¼Œä¸ºäº†ä½¿**Cost Function** å°½å¯èƒ½çš„å°ï¼Œæ‰€æœ‰çš„ $\theta $ çš„å€¼ï¼ˆä¸åŒ…æ‹¬${\theta_{0}}$ï¼‰éƒ½ä¼šåœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°ã€‚
ä½†è‹¥$\lambda$ çš„å€¼å¤ªå¤§äº†ï¼Œé‚£ä¹ˆ$\theta $ï¼ˆä¸åŒ…æ‹¬${\theta_{0}}$ï¼‰éƒ½ä¼šè¶‹è¿‘äº0ï¼Œè¿™æ ·æˆ‘ä»¬æ‰€å¾—åˆ°çš„åªèƒ½æ˜¯ä¸€æ¡å¹³è¡Œäº$x$è½´çš„ç›´çº¿ã€‚
æ‰€ä»¥å¯¹äºæ­£åˆ™åŒ–ï¼Œæˆ‘ä»¬è¦å–ä¸€ä¸ªåˆç†çš„ $\lambda$ çš„å€¼ï¼Œè¿™æ ·æ‰èƒ½æ›´å¥½çš„åº”ç”¨æ­£åˆ™åŒ–ã€‚
å›é¡¾ä¸€ä¸‹ä»£ä»·å‡½æ•°ï¼Œä¸ºäº†ä½¿ç”¨æ­£åˆ™åŒ–ï¼Œè®©æˆ‘ä»¬æŠŠè¿™äº›æ¦‚å¿µåº”ç”¨åˆ°åˆ°çº¿æ€§å›å½’å’Œé€»è¾‘å›å½’ä¸­å»ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è®©ä»–ä»¬é¿å…è¿‡åº¦æ‹Ÿåˆäº†ã€‚

### 2.1.3 æ­£åˆ™åŒ–çº¿æ€§å›å½’

æ­£åˆ™åŒ–çº¿æ€§å›å½’çš„ä»£ä»·å‡½æ•°ä¸ºï¼š

$J\left( \theta  \right)=\frac{1}{2m}\sum\limits_{i=1}^{m}{[({{({h_\theta}({{x}^{(i)}})-{{y}^{(i)}})}^{2}}+\lambda \sum\limits_{j=1}^{n}{\theta _{j}^{2}})]}$

å¦‚æœæˆ‘ä»¬è¦ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•ä»¤è¿™ä¸ªä»£ä»·å‡½æ•°æœ€å°åŒ–ï¼Œå› ä¸ºæˆ‘ä»¬æœªå¯¹$\theta_0$è¿›è¡Œæ­£åˆ™åŒ–ï¼Œæ‰€ä»¥æ¢¯åº¦ä¸‹é™ç®—æ³•å°†åˆ†ä¸¤ç§æƒ…å½¢ï¼š

$Repeat$  $until$  $convergence${

${\theta_0}:={\theta_0}-a\frac{1}{m}\sum\limits_{i=1}^{m}{(({h_\theta}({{x}^{(i)}})-{{y}^{(i)}})x_{0}^{(i)}})$

${\theta_j}:={\theta_j}-a[\frac{1}{m}\sum\limits_{i=1}^{m}{(({h_\theta}({{x}^{(i)}})-{{y}^{(i)}})x_{j}^{\left( i \right)}}+\frac{\lambda }{m}{\theta_j}]$

$for$ $j=1,2,...n$

}


å¯¹ä¸Šé¢çš„ç®—æ³•ä¸­$ j=1,2,...,n$ æ—¶çš„æ›´æ–°å¼å­è¿›è¡Œè°ƒæ•´å¯å¾—ï¼š
${\theta_j}:={\theta_j}(1-a\frac{\lambda }{m})-a\frac{1}{m}\sum\limits_{i=1}^{m}{({h_\theta}({{x}^{(i)}})-{{y}^{(i)}})x_{j}^{\left( i \right)}}$
å¯ä»¥çœ‹å‡ºï¼Œæ­£åˆ™åŒ–çº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™ç®—æ³•çš„å˜åŒ–åœ¨äºï¼Œæ¯æ¬¡éƒ½åœ¨åŸæœ‰ç®—æ³•æ›´æ–°è§„åˆ™çš„åŸºç¡€ä¸Šä»¤$\theta $å€¼å‡å°‘äº†ä¸€ä¸ªé¢å¤–çš„å€¼ã€‚

æˆ‘ä»¬åŒæ ·ä¹Ÿå¯ä»¥åˆ©ç”¨æ­£è§„æ–¹ç¨‹æ¥æ±‚è§£æ­£åˆ™åŒ–çº¿æ€§å›å½’æ¨¡å‹ï¼Œæ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š

![](https://user-gold-cdn.xitu.io/2019/2/21/1690dd9df5cbea1e?w=300&h=75&f=png&s=8241)

å›¾ä¸­çš„çŸ©é˜µå°ºå¯¸ä¸º $(n+1)*(n+1)$ã€‚

### 2.1.4 æ­£åˆ™åŒ–é€»è¾‘å›å½’æ¨¡å‹

è‡ªå·±è®¡ç®—å¯¼æ•°åŒæ ·å¯¹äºé€»è¾‘å›å½’ï¼Œæˆ‘ä»¬ä¹Ÿç»™ä»£ä»·å‡½æ•°å¢åŠ ä¸€ä¸ªæ­£åˆ™åŒ–çš„è¡¨è¾¾å¼ï¼Œå¾—åˆ°ä»£ä»·å‡½æ•°ï¼š

$J\left( \theta  \right)=\frac{1}{m}\sum\limits_{i=1}^{m}{[-{{y}^{(i)}}\log \left( {h_\theta}\left( {{x}^{(i)}} \right) \right)-\left( 1-{{y}^{(i)}} \right)\log \left( 1-{h_\theta}\left( {{x}^{(i)}} \right) \right)]}+\frac{\lambda }{2m}\sum\limits_{j=1}^{n}{\theta _{j}^{2}}$

**Python**ä»£ç ï¼š

```python
import numpy as np

def costReg(theta, X, y, learningRate):
    theta = np.matrix(theta)
    X = np.matrix(X)
    y = np.matrix(y)
    first = np.multiply(-y, np.log(sigmoid(X*theta.T)))
    second = np.multiply((1 - y), np.log(1 - sigmoid(X*theta.T)))
    reg = (learningRate / (2 * len(X))* np.sum(np.power(theta[:,1:theta.shape[1]],2))
    return np.sum(first - second) / (len(X)) + reg
```

è¦æœ€å°åŒ–è¯¥ä»£ä»·å‡½æ•°ï¼Œé€šè¿‡æ±‚å¯¼ï¼Œå¾—å‡ºæ¢¯åº¦ä¸‹é™ç®—æ³•ä¸ºï¼š

$Repeat$  $until$  $convergence${

   ${\theta_0}:={\theta_0}-a\frac{1}{m}\sum\limits_{i=1}^{m}{(({h_\theta}({{x}^{(i)}})-{{y}^{(i)}})x_{0}^{(i)}})$

   ${\theta_j}:={\theta_j}-a[\frac{1}{m}\sum\limits_{i=1}^{m}{({h_\theta}({{x}^{(i)}})-{{y}^{(i)}})x_{j}^{\left( i \right)}}+\frac{\lambda }{m}{\theta_j}]$

$for$ $j=1,2,...n$

}

è™½ç„¶çœ‹èµ·æ¥ä¸€æ ·çš„ğŸ˜‚ï¼Œä½†æ˜¯${h_\theta}\left( x \right)=g\left( {\theta^T}X \right)$ï¼Œæ‰€ä»¥æ˜¯ä¸åŒçš„ã€‚
